{% extends 'base.html' %}
{% block content %}
    <div class="profile-container">
        <section class="profile-info card">
            <div class="user-img">
                {% if user.profile.avatar.url %}
                    <img src="{{ user.profile.avatar.url }}" class="rounded-circle" width="150", height="150">
                {% else %}
                    <img src="https://picsum.photos/150" class="rounded-circle" width="150", height="150">
                {% endif  %}
            </div>
            <div class="card-body profile-info">
                <h3>My Profile</h3>
                <form method="post" enctype="multipart/form-data" class="profile-update">
                    {% csrf_token %}
                    <div class="form-group form-two">
                        <input type="text" name='username' placeholder='Username' value="{{user.username}}">
                        {{ form.city }}
                    </div>
                    <div class="form-group">
                        {{ form.avatar}}
                    </div>
                    <input type="submit" value="Update Profile">
                </form>
            </div>
        </section>
        <section class="user-posts">
            <div class="card profile-posts">
                <h4 class="city-posts">Your Posts</h4>
                {% for post in posts %}
                    <div class= "card-body inner-profile-post">
                        {% if user.profile.avatar.url %}                        
                        <img src="{{ user.profile.avatar.url }}" class="rounded-circle" width="50px", height="50px">
                        {% else %}
                        <img src="https://picsum.photos/150" class="rounded-circle" width="50px", height="50px">
                        {% endif %}
                        <div class="inner-profile-post-info">
                        <a href="{% url 'posts' post.id%}">{{post.title}}</a>
                        <p>{{post.content|slice:"0:44"}} <a href="{% url 'posts' post.id%}">Read More...</a></p>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="card profile-posts">
                <h4 class="city-posts">Posts from {{user.profile.get_city_display}}</h4>
                {% for post in posts %}
                    {% if  post.city.name == user.profile.get_city_display%}
                    <div class= "card-body inner-profile-post">
                        <img src="{{ post.user.profile.avatar.url }}" class="rounded-circle" width="50px", height="50px">
                        <div class="inner-profile-post-info">
                        <a href="{% url 'posts' post.id%}">{{post.title}}</a>
                        <p>{{post.content|slice:"0:44"}} <a href="{% url 'posts' post.id%}">Read More...</a></p>
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
        <p class="user-city" style="display:none">{{user.profile.city}}</p>
        </section>
    </div>
    {% comment %} {{user.username}}
    {{user.date_joined}}
    {{user.profile.get_city_display}} {% endcomment %}
    
    


{% endblock content %}